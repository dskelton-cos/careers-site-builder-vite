function SFDatePickerWidget(a,b){this.register(),this._init(a,b)}SFDatePickerWidget.VIEW_TYPE_LINK="link",SFDatePickerWidget.FIELD_TYPE_DATE="DATE",SFDatePickerWidget.FIELD_TYPE_CAL="calendar",SFDatePickerWidget.prototype=function(){var a=SFDatePickerWidget.VIEW_TYPE_LINK;return juic.set(new juic.Component,{ISO8601Dateformatter:new DateFormat("yyyy-MM-dd",null,null,Util.GREGORIAN),_init:function(b,c){c=c||{},c.dateFormatter=MSGS.COMMON_DateFormat,c.placeholder=MSGS.COMMON_DateFormatExample,c.label=c.label||MSGS.COMMON_Date_Picker,this._config=c,this._ectControl=!!c.ectControl,this._defaultToday=c.defaultToday,this._writable=!1!==c.writable,this.updateReadOnlyClassName(),this._viewType=c.viewType,this._isLink=this._viewType===a,this._isModified=!1,this._isRequired=c&&c.required,this._name=c.name||"",this._sfError=new SFInlineError(""),this._handleBuddhistCalendar=!0===c.detectThaiBuddhistMode,this._isThaiBuddhistCalendar=this.isThaiBuddhistCalendar(),b&&"string"!=typeof b&&(console.warn("Date value must be a string. Falling back to empty string. Recieved: ",b),b=""),this.setInitialValue(b),!1!==c.useWidget&&this._initWidget(),c.delayedRendering&&this.applyDeplayedRendering()},_initWidget:function(){WidgetUtil.getWidget("xweb/calendar-widget",this._handleWidgetCallback.bind(this))},_handleWidgetCallback:function(a){this.widget=a,this.appEventBus=a.getEventBus()(),this._addListeners(),this._handleOnAfterRender()},_addListeners:function(){this.appEventBus.addEventListener("_change",this._change.bind(this)),this.appEventBus.addEventListener("invalid",this._onError.bind(this)),this.appEventBus.addEventListener("ready",this._onReady.bind(this))},_handleOnAfterRender:function(){var a=juic.$(this.getReferenceId());if(a&&null!=this.widget){var b=a.querySelector(".placeholderImg");b&&a.removeChild(b),"advFilterAsOfDate"===this._config.metaId&&(a.style.position="absolute"),this.widget.getDatePicker()(a,this.getValue(),this.getConfig(),this.appEventBus)}},_onReady:function(){this.isWidgetReady=!0,this._value&&this.appEventBus.fireEvent("value",this._value),this.fireEventsInQueue(),this.waitUntilDefined().then(this._addBlurListener.bind(this)),this.dispatch("ready")},waitUntilDefined:function(){return window.customElements.whenDefined("ui5-input-xweb-calendar-widget")},_addBlurListener:function(){var a=this.getElement();a&&a.addEventListener("focusout",this._focusOut.bind(this))},_focusOut:function(){this.dispatch("blur")},_change:function(a){var b=Object.assign({},a.getParameters(),{name:this._name}),c=a.getParameter("actionCommand"),d=a.getParameter("value");this._isModified=!("fieldChange"!==c),this._oldValue=a.getParameter("oldValue"),this.isEmptyObject(this.getOnChangeParams())||this.addOnChangeParams(b,d),this._hasError=!1,this._invalid=!1,this._sfError.setValue(""),this._formatValue(d),this._hideCalendar(),this.checkForErrors(),(!this._hasError||this._config.isDispatchChangeEvent)&&this.dispatch("change",b)},_onError:function(){this._hasError=!0,this._invalid=!0,this._value=this._getElementValue(),this.setErrorMsg(this.getInvalidDateMsg())},_fireEvent:function(a,b){this.isWidgetReady?this.appEventBus.fireEvent(a,b):this.addEventToQueue(a,b)},setRequired:function(a){this._isRequired=a,this._fireEvent("required",a)},setAriaLabel:function(a){this._fireEvent("label",a)},setTitle:function(a){this._fireEvent("title",a)},setInitialValue:function(a){var b="";a&&0!==a.trim().length&&this.isDateValue(a)?b=a:this._defaultToday&&(b=this.ISO8601Dateformatter.format(new Date)),this._formatValue(b),this._oldValue||(this._oldValue=this._value)},setValue:function(a){if((this.isDateValue(a)||""===a)&&(this._formatValue(a),this._isModified=!0,this._fireEvent("value",this._value),!this._writable)){var b=juic.$(this.id+"_read");b&&(b.innerHTML=this._value)}},isRequired:function(){return this._isRequired},isModified:function(){return this._isModified},isGlobalCalendarPreferencesEnabled:function(){return!!this.getPageMetaData().calendarPreferences},isThaiBuddhistCalendar:function(){if(this.isGlobalCalendarPreferencesEnabled())return Util.BUDDHIST===this.getPrimaryCalendarType();if(!this._handleBuddhistCalendar)return!1;var a=this.getPageMetaData(),b=function(a){var b=document;return b.querySelector&&b.querySelector("meta[id=\""+a+"\"], meta[name=\""+a+"\"]")},c=(a.userInfo||{}).normalizedLocale;return c||(c=b("normalizedLocale")),c||(c=a.userLocale),c||(c=b("locale")),c&&0<=c.indexOf("th_TH")},reset:function(){this._isModified&&(this._isModified=!1,this.setValue(this._oldValue),this._hideCalendar())},cleanup:function(){this._hideCalendar(),this._fireEvent("destroy"),this.unregister()},_hideCalendar:function(){var a=this.getElement();if(this._isLink){var b=this.getCalendarPopover();b&&b.isOpen()&&b.close()}else a&&a.isOpen()&&a.closePicker()},isDateValue:function(a){return a!==MSGS.COMMON_DateFormatExample},isISODateString:function(a){return /^[+-]?(\d+)-(\d+)-(\d+)$/.test(a)},_formatValue:function(a){if(a&&0!=a.trim().length&&this.isDateValue(a)){var b=null;this.isISODateString(a)&&(b=this.ISO8601Dateformatter.parse(a.trim())),this._value=b?this.getFormatter().format(b):a}else this._value=""},getFormatter:function(){if(!this.dateformatter){var a,b=this._config.primary;b?a=b:this._isThaiBuddhistCalendar&&(a=Util.BUDDHIST),this.dateformatter=new DateFormat(MSGS.COMMON_DateFormat,null,null,a)}return this.dateformatter},getPageMetaData:function(){var a=window,b=a.pageHeaderJsonData;return b||(a=a.parent,b=a.pageHeaderJsonData),b||{}},getValue:function(){return this._getFormattedValue(this.getValueLocalFormat())},_getFormattedValue:function(a){if(a&&a.length){var b=this.getFormatter().parse(a);return b?this.ISO8601Dateformatter.format(b):"INVALID"}return""},getValueLocalFormat:function(){return this._value},_setElementValue:function(a){var b=this.getElement();b&&(this._isLink?b.innerHTML=a:b.value=a)},_getElementValue:function(){var a=this.getElement();return a?this._isLink?a.innerHTML:null==a.liveValue?a.value:a.liveValue:this._value},getElement:function(){var a=this.getRootElement();return a&&a.querySelector&&a.querySelector("[data-testid="+this.getWebComponentId()+"]")},getWebComponentId:function(){return this._isLink?"datePickerLink":"datePicker"},getRootElement:function(){return document.getElementById(this.getReferenceId())},getCalendarPopover:function(){var a=this.getRootElement();return a&&a.querySelector&&a.querySelector("[data-testid='calendar-popover']")},getConfig:function(){return Object.assign({},this._config,this._getOptions())},_getOptions:function(){var a=this.getCalendarTypes(),b={writable:this._writable};return Object.assign({},a,b)},getPrimaryCalendarType:function(){var a=this.getPageMetaData(),b=a.calendarPreferences;return b&&b.primaryCalendarType},getCalendarTypes:function(){var a=this._config.primary,b=this._config.secondary;return a||(a=this._isThaiBuddhistCalendar?"Buddhist":""),b||(b=""),{primary:a,secondary:b}},getClasses:function(){var a="datePicker";return this._ectControl&&(a+=" ectControl ",!this.isFioriFDEnabled()&&(a+="sapUiSizeCompact ")),a},getStyles:function(){var a="";return this._ectControl||(a+="min-width:12.5625rem;"),a},addEventToQueue:function(a,b){var c={};c[a]=b,this.eventQueue=this.eventQueue?Object.assign({},this.eventQueue,c):c},fireEventsInQueue:function(){if(this.eventQueue){for(evt in this.eventQueue)this.eventQueue.hasOwnProperty(evt)&&this.appEventBus.fireEvent(evt,this.eventQueue[evt]);this.eventQueue=null}},maybeDestroyWidget:function(){this.getElement()&&this.isWidgetReady&&this._fireEvent("destroy")},renderHtml:function(a){a.push("<div id="+this.id+"_datepicker style='"+this.getStyles()+"' class='"+this.getClasses()+"'>"),a.push("<img class='placeholderImg' style='position:absolute' src='"+Util.placeholderImg+"' onload='"+this.fireCode("_handleOnAfterRender")+"' onerror='"+this.fireCode("_handleOnAfterRender")+"'/>"),this.maybeDestroyWidget(),a.push("</div>"),this._ectControl&&a.push("<span id='"+this.id+"_read' class='"+this._readOnlyClass+"'>"+this._value+"</span>")},applyDeplayedRendering:function(){function a(){var d=juic.$(c.getReferenceId());d?(c._handleOnAfterRender(),clearTimeout(b)):b=setTimeout(a,100)}var b,c=this;b=setTimeout(a,100)},initByDefaultMetaValue:function(){var a=this._config,b=a&&a.defaultValue,c=this._value?this.getValue():this._value;b&&""!==b&&""===c&&(this._prevValue=b,this._oldValue=b,this.setValue(b),this._defaultedWithMetaValue=!0)},getPreviousValue:function(){return this._prevValue||this._oldValue},updatePreviousValue:function(){this._prevValue=this.getValue()},_prepareForUse:function(){},isWritable:function(){return this._writable},setWritable:function(a){this._writable=a,this._fireEvent("readOnly",!a),this.updateReadOnlyClassName()},updateReadOnlyClassName:function(){this._readOnlyClass="readonly"+(this._writable?" readComp":" read_only"),this._config&&this._config.fontConfig&&this._config.fontConfig.value&&(this._readOnlyClass+=" "+(window.ECTFontConfig?ECTFontConfig.getClassNames(this._config.fontConfig.value):""))},setFocus:function(){var a=this;setTimeout(function(){var b=a.getElement(),c=b&&b._getInput&&b._getInput();c&&c.focus()},10)},setErrorMsg:function(a){this._hasError=!!a,this._errorMsg=this._hasError?a:"",this._sfError.setValue(this._errorMsg),this._fireEvent("errorMsg",this._errorMsg)},getErrorMsg:function(){return this._errorMsg},getInvalidDateMsg:function(){return sfMessageFormat.format(MSGS.COMMON_ERR_DATA_FORMAT,this._getValidatorLabel(),sfMessageFormat.format(MSGS.COMMON_ERR_DATA_EXPECTED,MSGS.COMMON_DateFormatExample))},getReferenceId:function(){return this.id+"_datepicker"},_getWrapperClassName:function(){return""},_updateWrapperClassName:function(){},_getFontColor:function(){return""},resetError:function(){this.setErrorMsg("")},checkForErrors:function(){var a=this._hasError?this.getErrorMsg():"";return this._isRequired&&""===this._value&&(a=sfMessageFormat.format(MSGS.COMMON_ERR_DATA_REQUIRED,this._getValidatorLabel())),this.setErrorMsg(a),this._hasError},_getValidatorLabel:function(){return this._validatorLabel||this._config.label||MSGS.COMMON_Date_Picker},bindValidators:function(a){this.bindSpecificValidators(a)},bindSpecificValidators:function(a){this._validatorLabel=a.label},isEmptyObject:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},isFocus:function(){return document.activeElement===this.getElement()},addOnChangeParams:function(a,b){(a||{}).onChangeParams=Object.assign({},this._onChangeParams,{metaId:this.metaId,previousValue:this._value,value:b})},getOnChangeParams:function(){return this._onChangeParams||{}},setOnChangeParams:function(a){this._onChangeParams=a},setEnabled:function(a){this._enabled=a,this._fireEvent("enabled",a)},isEnabled:function(){return this._enabled},_renderWriteHtml:function(a){this.renderHtml(a)},_drawRoundedCorners:function(a){this._renderWriteHtml(a)},hideCalendar:function(){this._hideCalendar()},_hidecalendar:function(){this._hideCalendar()},displayErrorMessage:function(){},hideErrorMessage:function(){this.resetError()},validate:function(){return!this._hasError}})}();