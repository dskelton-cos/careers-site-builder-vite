var j2w=j2w||{};
j2w.SSO=function(){var b={},c=!1,e="needPwd",f=void 0,k="",g=function(a){!j2w.SSO.getPassword()&&"string"===typeof a&&a.length&&(b.pwd=j2w.SSO.caramelize(a))},h=function(a){$.ajax({url:"/opbc/"+j2w.SSO.getJobID()+"/",type:"POST",data:a,dataType:"html",error:function(a,b,e){j2w.Util.recoverFromAjaxError(a)},success:function(b){j2w.SSO.isRD()&&769>window.innerWidth?($("#viewOnPageBusinessCardMobile").removeClass("hidden"),$("body").addClass("noScroll"),$("#viewOnPageBusinessCardMobile div.opbcForm").html(b),a.socialsrc&&
$("#viewOnPageBusinessCardMobile div.opbcFooter, #tcNextButtonBar").hide(),$("#viewOnPageBusinessCardMobile").off("shown.bs.modal").on("shown.bs.modal",function(){0==$("body").hasClass("modal-open")&&$("body").addClass("modal-open");j2w.SSO.doResize();$(this).find(":header:first").focus()}),$("#viewOnPageBusinessCardMobile").off("hide.bs.modal").on("hide.bs.modal",function(a){abortXHR(a)}),$("#opbc-pp-privacypolicylink").click(function(a){$("#pp-accordion a.accordion-toggle").trigger("click");a.preventDefault()}),
j2w.SSO.showStack("viewOnPageBusinessCardMobile")):($("#viewOnPageBusinessCard div.opbcForm").html(b),a.socialsrc&&$("#viewOnPageBusinessCard div.modal-footer, #tcNextButtonBar").hide(),$("#viewOnPageBusinessCard").off("hide").on("hide",function(a){abortXHR(a)}),$("#viewOnPageBusinessCard").off("shown").on("shown",function(){j2w.SSO.doResize();$(this).find(":header:first").focus()}),$("#viewOnPageBusinessCard").off("shown.bs.modal").on("shown.bs.modal",function(){0==$("body").hasClass("modal-open")&&
$("body").addClass("modal-open");j2w.SSO.doResize();$(this).find(":header:first").focus()}),$("#viewOnPageBusinessCard").off("hide.bs.modal").on("hide.bs.modal",function(a){abortXHR(a)}),$("#opbc-pp-privacypolicylink").click(function(a){$("#pp-accordion a.accordion-toggle").trigger("click");a.preventDefault()}),j2w.SSO.showStack("viewOnPageBusinessCard"));$(document).trigger("TCFormHead.documentReady").trigger("TCForm.documentReady").trigger("tcJoin.documentReady").trigger("tcJoin.windowReady").trigger("TCFormSocialScripting.windowLoad")}})},
l=function(){var a={email:j2w.SSO.getEmail(),locale:j2w.SSO.getLocale()};j2w.Apply.getSocialSource().length&&(a.reviewtoken="socialApply",a.tcsetuptype="social",a.socialsrc=j2w.Apply.getSocialSource());switch(a.socialsrc){case "xi":"undefined"!==typeof xingUser?h(a):socialApplyCheckXI();break;case "sk":h(a);break;default:h(a)}},n=function(a){j2w.SSO.$stack.lightbox_me({zIndex:1050,centered:!0,closeClick:!1,closeEsc:!1,closeSelector:".mobSSOClose",onClose:function(){$("#ssoStack ul.errorMessages").empty();
j2w.SSO.isRD()&&769>window.innerWidth&&$("body").removeClass("noScroll");"function"===typeof restoreSocialApplyOptions&&restoreSocialApplyOptions();window.j2w.applyInProgress=!1;"apply"===j2w.SSO.getTCAction()&&$(document).trigger("ssoExit")},onLoad:function(){$(".stackView").hide().find(".ssoUserEmail").text(j2w.SSO.getEmail()).end().find('[custIdentifier="rmpLoginEmail"]').val(j2w.SSO.getEmail());$("#"+a).show().find("input:visible").first().focus().select();j2w.SSO.$stack.trigger("reposition");
"function"===typeof closeSocialApplyOptions&&closeSocialApplyOptions()},overlaySpeed:"fast"})};return{apiKey:"",heightWatch:void 0,pwd:void 0,ready:!1,tmp:{email:void 0,pwd:void 0},usingRD:!1,usingRDv3:!1,urlVars:{},init:function(a){c?a=!1:(b=a,a=c=!0);return a},Args:{get:function(a){return j2w.Args.get(a,b)}},isEnabled:function(){return j2w.Args.get("enabled",b)},isRD:function(){return j2w.Args.get("usingRD",b)},getEmail:function(){return j2w.Args.get("email",b)},setEmail:function(a){b.email=a},
setEmailPwd:function(a,m){b.email=a;g(m)},getJobID:function(){return j2w.Args.get("jobID",b)},getLocale:function(){return j2w.Args.get("locale",b)},getPassword:function(){return j2w.Args.get("pwd",b)},setPassword:function(a){g(a)},getRMPLoginIntent:function(){return e},getRMPAuthCallback:function(){return f},getTCAction:function(){return j2w.Args.get("tcaction",b)},getSSOAction:function(){return k},setSSOAction:function(a){k=a},askForRMPAuth:function(a){a&&"function"===typeof a?f=a:(f=void 0,e="sessionExpired");
j2w.SSO.isRD()&&769>window.innerWidth?($("#viewRMPAuthMobile").removeClass("hidden"),$("body").addClass("noScroll"),j2w.SSO.showStack("viewRMPAuthMobile")):j2w.SSO.showStack("viewRMPAuth")},atsCreationResponseCheck:function(a){if(a.userHasATSUserID)j2w.SSO.isRD()&&769>window.innerWidth?($("#viewATSAuthMobile").removeClass("hidden"),$("body").addClass("noScroll"),j2w.SSO.showStack("viewATSAuthMobile")):j2w.SSO.showStack("viewATSAuth");else if("number"===typeof j2w.applyID)j2w.Apply.goToJob();else if("job"!==
j2w.SSO.getTCAction()||a.dpcsOk)$(document).trigger("ssoExit");else{a=j2w.SSO.getJobID();var b={};j2w.Apply.isUseOnPageBusinessCard()?j2w.SSO.openOPBC():j2w.Apply.goToApply(!1,b,a)}},caramelize:function(a){return a&&a.length?a.replace(/[a-zA-Z]/g,function(a){return String.fromCharCode(("Z">=a?90:122)>=(a=a.charCodeAt(0)+13)?a:a-26)}):a},closeStack:function(a){"boolean"===typeof a&&(j2w.SSO.isRD()&&769>window.innerWidth?j2w.SSO.$stack.trigger("close"):a?j2w.SSO.$stack.find("#viewRMPAuth").modal("hide"):
j2w.SSO.$stack.trigger("close"))},doResize:function(){var a=$(window).height(),b=$("#viewOnPageBusinessCard:visible"),d=b.outerHeight()+.2*a;$(window).height()<d&&b.length&&j2w.SSO.heightWatch!=a&&(d=b.find(".modal-body").outerHeight()-b.find(".modal-body").height(),d=.8*a-b.find(".modal-header").outerHeight()-b.find(".modal-footer").outerHeight()-d,d+="px",b.find(".modal-body").css({maxHeight:d}),j2w.SSO.heightWatch=a)},fieldLabelGetter:function(a){a=a.prevAll("label").first();return a.length?a.html().replace(/\*/,
""):""},forwardToApply:function(){j2w.SSO.$stack.trigger("close");j2w.Apply.countApplyGoToJob(j2w.SSO.getJobID())},localeFormattedMessageForFieldLabel:function(a,b){return jsStr[a].format(j2w.SSO.fieldLabelGetter(b)).unescapeHTML()},logoutHandler:function(a){void 0==j2w.SAB&&(document.location.href=j2w.Args.get("logoutDefaultPath",b));j2w.SAB.email=void 0;null!=j2w.SAB.$activeButton&&j2w.SAB.$activeButton.find(".emailGetter").find("input[type=email]").val(void 0);j2w.SSO.start()},resetPasswordDone:function(a){j2w.SSO.$stack.find("form:visible").before('<div class="resetMessage alert alert-info">'+
jsStr.tcpwhasbeenreset.unescapeHTML()+"</div>")},rmpLoginResponse:function(a){"false"===a.lockedOut.toString()?"true"===a.passwordIsValid.toString()?(b.email=j2w.SSO.tmp.email,g(j2w.SSO.caramelize(j2w.SSO.tmp.pwd)),j2w.SSO.ssoATSAccountCheck()):(j2w.SSO.ssoErrorClear(),j2w.SSO.ssoErrorPresent([jsStr.tcloginfailed]),j2w.SSO.ssoFirstFieldFocus()):(j2w.SSO.ssoErrorClear(),j2w.SSO.ssoErrorPresent([jsStr.tclockedout]),j2w.SSO.ssoFirstFieldFocus());j2w.SSO.tmp.email=j2w.SSO.tmp.pwd=void 0},showStack:function(a){"string"===
typeof a&&a.length&&$("#"+a).length&&(j2w.SSO.ssoErrorClear(),j2w.SSO.isRD()&&769<window.innerWidth?(j2w.SSO.$stack.find(".modal:visible").modal("hide"),$("#"+a).modal("show")):(j2w.SSO.$stack.find(".stackView").hide(),n(a)));return j2w.SSO.$stack},ssoErrorClear:function(){var a=j2w.SSO.$stack.find("ul.errorMessages:visible");a.empty();j2w.SSO.isRD&&(a.closest("div").removeClass("alert alert-error"),j2w.SSO.$stack.find("div.resetMessage").remove())},ssoErrorPresent:function(a){var b=$("#ssoStack ul.errorMessages:visible");
$.each(a,function(d){b.append("<li>"+a[d]+"</li>")});j2w.SSO.isRD&&b.closest("div").addClass("alert alert-error alert-danger")},ssoFirstFieldFocus:function(){j2w.SSO.$stack.find(".stackView:visible input:visible").first().focus().select()},ssoPwdFocus:function(){j2w.SSO.$stack.find("input[type=password]:visible").focus().select()},start:function(a){j2w.SSO.setEmail(j2w.SAB.email);j2w.Apply.isExistingMember(j2w.SAB.email,function(){j2w.SSO.isRD()&&769>window.innerWidth?($("#viewRMPExistingLoginMobile").removeClass("hidden"),
$("body").addClass("noScroll"),j2w.SSO.showStack("viewRMPExistingLoginMobile")):j2w.SSO.showStack("viewRMPExistingLogin")},function(){j2w.Apply.isUseOnPageBusinessCard()?l():j2w.Apply.goToApply(!1,a,j2w.Apply.Args.get("jobID"))})},openOPBC:function(){j2w.Apply.isUseOnPageBusinessCard()&&!$("#viewOnPageBusinessCardMobile, #viewOnPageBusinessCard").is(":visible")&&l()}}}();
$(function(){j2w.SSO.$stack=$("#ssoStack");$(document).bind("ajaxStart",function(){$(j2w.SSO.$stack).find(".signInProgress").show()}).bind("ajaxStop ajaxError",function(){$(j2w.SSO.$stack).find(".signInProgress").hide()});$(window).resize(function(){j2w.SSO.doResize()});j2w.SSO.$stack.find("div.modal").on("hide.bs.modal",function(b){j2w.SSO.$stack.find("ul.errorMessages").empty().closest("div").removeClass("alert alert-error");"function"===typeof restoreSocialApplyOptions&&restoreSocialApplyOptions();
window.j2w.applyInProgress=!1;"apply"===j2w.SSO.getTCAction()&&"ssoVerify"!==j2w.SSO.getSSOAction()&&$(document).trigger("ssoExit")});j2w.SSO.$stack.find("div.modal").on("show.bs.modal",function(b){"function"===typeof closeSocialApplyOptions&&closeSocialApplyOptions()});j2w.SSO.$stack.find("div.modal").on("show.bs.modal",function(b){j2w.SSO.$stack.find(".ssoUserEmail").text(j2w.SSO.getEmail()).end().find('[custIdentifier="rmpLoginEmail"]').val(j2w.SSO.getEmail());j2w.SSO.$stack.find("input:visible").first().focus().select()});
$(document).bind("ssoExit",function(){"number"===typeof j2w.applyID?j2w.Apply.goToJob():"apply"===j2w.SSO.getTCAction()?finallyComplete(j2w.SSO.getTCAction(),j2w.SSO.getJobID()):"profile"===j2w.SSO.getTCAction()?j2w.SSO.$stack.trigger("close"):j2w.SSO.forwardToApply()});typeof j2w.SSO.$stack.length&&-1<$.inArray(j2w.SSO.getTCAction(),["apply","job","profile"])&&(j2w.SSO.ready=!0,j2w.SSO.$stack.find("#frmMemberLogin").bind("keyup",function(b){13===b.keyCode&&$("#btnMemberLogin").trigger("mouseup")}),
j2w.SSO.$stack.find("#frmRMPExistingLogin").bind("keyup",function(b){13===b.keyCode&&$("#btnExistingLogin").trigger("mouseup")}),j2w.SSO.$stack.find("#frmRMPExistingLoginMobile").bind("keyup",function(b){13===b.keyCode&&$("#btnExistingLoginMobile").trigger("mouseup")}),j2w.SSO.$stack.find("#ssoNotYou, #ssoOPBCNotYou").bind("keyup",function(b){if(13===b.keyCode)return b.preventDefault(),j2w.Util.logout(j2w.SSO.logoutHandler),!1}),j2w.SSO.$stack.find("#ssoNotYou, #ssoOPBCNotYou").bind("mouseup",function(b){j2w.Util.logout(j2w.SSO.logoutHandler);
b.preventDefault()}),j2w.SSO.$stack.find("#ssoClose, a.ssoCancel").bind("mouseup",function(b){j2w.SSO.$stack.trigger("close");b.preventDefault()}),j2w.SSO.$stack.find("a.ssoATSCancel").bind("mouseup",function(b){$(document).trigger("ssoExit");b.preventDefault()}),j2w.SSO.$stack.find("#btnNewUser").bind("mouseup",function(b){var c="/talentcommunity/apply/"+j2w.SSO.getJobID()+"/",e=[];$.each(j2w.SSO.urlVars,function(b,c){"string"!==typeof c&&"number"!==typeof c||e.push(b+"="+encodeURIComponent(c))});
e.push("locale="+j2w.SSO.getLocale());e.length&&(c+="?"+e.join("&"));j2w.SSO.$stack.trigger("close");document.location.href=c;b.preventDefault()}),j2w.SSO.$stack.find(".forgotPwd a").click(function(){j2w.SSO.ssoErrorClear();j2w.Util.resetPassword(j2w.SSO.getEmail(),j2w.SSO.resetPasswordDone)}),j2w.SSO.$stack.find(".forgotPwdLogin a").click(function(){var b=j2w.SSO.$stack.find('[custIdentifier="rmpLoginEmail"]:visible').val();j2w.SSO.ssoErrorClear();if(j2w.Validation.isEmailNoWhitespace(b))j2w.Util.resetPassword(b,
j2w.SSO.resetPasswordDone);else return j2w.SSO.ssoErrorPresent([jsStr.tcminvalidemailmessage]),j2w.SSO.ssoFirstFieldFocus(),!1}))});
