function RTEditor(e,t){juic.assert({object:1,undefined:1}[typeof t],"options argument is not an object"),RTEditor.prototype.totalInstances?++RTEditor.prototype.totalInstances:RTEditor.prototype.totalInstances=1,this.numInstance=RTEditor.prototype.totalInstances,this._gname="juic_RTEditor_"+this.numInstance,window[this._gname]=this,this._setValueInternal(e),this._valueOriginal=this._valueSet,this._prevValue=this._valueSet,this._options=t||{},this._options.name&&(this.gnameAlt="juic_RTEditor_alt_"+this._options.name,window[this.gnameAlt]=this),this._useDefaultLabel=!!this._options.label,this._label=this._useDefaultLabel?MSGS.get("COMMON_RTE_LABEL",juic.escapeHTML(this._options.label)):MSGS.COMMON_RTE_DESCRIPTION,this._initPanelDimensions(),juic.assert({string:1,undefined:1}[typeof this._options.name],"options.name is not a string"),this._init()}RTEditor.msgs=window.MSGS||{},RTEditor.DEFAULT_HIGHLIGHT_BG_COLOR="#FCC",function(){function e(e,t){return function(){return t.apply(e,arguments)}}function t(e,t){this.register(),this._max=e,this._count=t?t:0}function n(e,t,n,o,i){this.title=t?t:e,this.cssClass=n,this.hex=i,this._options=o||{},this.register()}function o(e,t,n,o,i,a){this.optionsList=n,this.title=e,this.desc=t,this._defaultOption=o,this.dropdown=new SFDropDown(this.optionsList,this.title,this.desc),this.dropdown.setClassName("nrte_select"),this.register();var l=this;if(a&&i){function e(e,t){this.handleEvent=function(){a._execCommand(e,t,l.getValue())}}this.dropdown.addEventListener("change",new e(i))}}function i(e,t){this._optionsMButton=e||{},this._optionsToolbar=t||{},this.register();var o=RTEditor.msgs;this.btn=new n(o.COMMON_RTE_TOOLBAR_TEXT_COLOR||"Text Color",o.COMMON_RTE_TOOLBAR_TEXT_COLOR_BUTTON_DESC,"textColor",this._optionsMButton),this.btn.addEventListener("click",{el:this,handleEvent:function(){this.el.showDisplay()}}),this.colors=[new n(o.COMMON_RTE_TOOLBAR_TEXT_COLOR_RED||"Red",null,"red",this._optionsToolbar.buttons,"#FF0000"),new n(o.COMMON_RTE_TOOLBAR_TEXT_COLOR_ORANGE||"Orange",null,"orange",this._optionsToolbar.buttons,"#FF6600"),new n(o.COMMON_RTE_TOOLBAR_TEXT_COLOR_YELLOW||"Yellow",null,"yellow",this._optionsToolbar.buttons,"#FFFF00"),new n(o.COMMON_RTE_TOOLBAR_TEXT_COLOR_GREEN||"Green",null,"green",this._optionsToolbar.buttons,"#008000"),new n(o.COMMON_RTE_TOOLBAR_TEXT_COLOR_BLUE||"Blue",null,"blue",this._optionsToolbar.buttons,"#0000FF"),new n(o.COMMON_RTE_TOOLBAR_TEXT_COLOR_VIOLET||"Violet",null,"violet",this._optionsToolbar.buttons,"#6363FF"),new n(o.COMMON_RTE_TOOLBAR_TEXT_COLOR_BLACK||"Black",null,"black",this._optionsToolbar.buttons,"#000000")];for(var i=0;i<this.colors.length;++i)this.colors[i].addEventListener("click",{el:this,color:this.colors[i].hex,handleEvent:function(){this.el.dispatch("color",{color:this.color})}})}function a(){return"<script type='text/javascript'>setTimeout(function () { document.forms[0].submit(); }, 1);</script>"}var l=Util.browserInfo.ff,_=Util.browserInfo.saf,d=Util.isChrome(),s=l||_||d,r=_&&!d&&/Mobile/.test(navigator.userAgent)&&5.1>Util.safariVersion(),p=Util.ieVersion(!0)||_&&!r||d||l,u=Util.isFioriFDEnabled();t.prototype=function(){function e(e,t){return 0<e-t?e-t:0}return juic.set(new juic.Component,{renderHtml:function(e){e.push("<span id=\""+this.id+"\" class=\"nrte_char_counter\" title=\"",MSGS.COMMON_RTE_COUNTER_CHARACTER_MESSAGE,"\">"),this.renderInner(e),e.push("</span>")},renderInner:function(t){var n=e(this._max,this._count);t.push("Chars left: ",0==n?"<span style=\"color:red\">":"",n,0==n?"</span>":"")},setMax:function(e){if(this._max=e,juic.$(this.id)){var t=[];this.renderInner(t),juic.$(this.id).innerHTML=t.join("")}},getMax:function(){return this._max},setCount:function(e){if(this._count=e,juic.$(this.id)){var t=[];this.renderInner(t),juic.$(this.id).innerHTML=t.join("")}},getCount:function(){return this._count}})}(),RTEditor.attachTBBtnEvent=function(e){for(var t,n=juic.$(e),o=n.getElementsByTagName("a"),i=0,a=o.length;i<a;i++)t=o[i],t.id&&0==t.id.indexOf("link_icon_")&&t.rel&&(t.onclick=function(e){return juic.fire(this.rel,"_click",e),!1},t.onkeydown=function(e){var t=SFDOMEvent.getCharCode(e);t===SFDOMEvent.KEY_CODE.SPACE&&(e.preventDefault(),juic.fire(this.rel,"_click",e))},t.onmousedown=function(e){return e=e||event,juic.fire(this.rel,"_down",e),!1},t.onmouseup=function(e){return e=e||event,juic.fire(this.rel,"_up",e),!1},t.onmouseover=function(e){return e=e||event,juic.fire(this.rel,"_over",e),!1},t.onmouseout=function(e){return e=e||event,juic.fire(this.rel,"_out",e),!1})},n.prototype=juic.set(new juic.Component,{_DEFAULT_BORDER_COLOR:"#ececec",_active:0,_hover:0,_pressed:0,renderHtml:function(e){this.id+"_desc";e.push("<div role='none' id='",this.id,"' style='"+(u?"":"border-color:"+this._getOptBorderColor()+";")+"' class='nrte_button_div'><a href='javascript:void(0)' id='link_icon_",this.id,"' title='",juic.escapeHTML(this.title),"'"),e.push(" role='button' class='nrte_button_link ",this.cssClass," ",Util.generateFDClasses("link")),this._options&&this._options.disabled&&e.push(" disabled"),e.push("'"),this._options&&this._options.disabled?e.push(" onclick=\"return false;\" "):e.push(" rel=\"",this.id,"\""),e.push(" ondragstart='javascript:return(false);'"),e.push(" unselectable='on'>"),e.push("</a>"),e.push("</div>")},getPos:function(){var e=juic.$(this.id);return Util.getAbsPos(e)},_click:function(){this.dispatch("click")},_getOptBorderColor:function(){return this._options&&this._options.border&&this._options.border.color?this._options.border.color:this._DEFAULT_BORDER_COLOR},_updateView:function(){var e=juic.$(this.id);if(e)if(u){var t="nrte_button_div";this._options&&this._options.disabled||(this._active||this._pressed?t+=" nrte_button_div_active":this._hover&&(t+=" nrte_button_div_hover")),e.className=t}else{var n=this._getOptBorderColor();this._options&&this._options.disabled||(this._active?n="#808080 #fff #fff #808080":this._pressed?n="#808080 #fff #fff #808080":this._hover&&(n="#fff #808080 #808080 #fff")),e.style.borderColor=n}},setActive:function(e){this._active=e,this._updateView()},_over:function(){this._hover=1,this._updateView()},_out:function(){this._hover=0,this._pressed=0,this._updateView()},_down:function(){this._pressed=1,this._updateView()},_up:function(){this._pressed=0,this._updateView()}}),o.prototype=juic.set(new juic.Component,{renderHtml:function(e){return this.dropdown.renderHtml(e),e},getValue:function(){return this.dropdown.getValue()},setValue:function(e){e?this.dropdown.setValue(e,!0):this._defaultOption&&this.dropdown.setValue(this._defaultOption,!0)},cleanup:function(){this.dropdown.cleanup(),this.unregister()}}),i.prototype=juic.set(new juic.Component,{_DEFAULT_BACKGROUND_COLOR:u?"var(--sapToolbar_Background)":"#eee",_DEFAULT_BORDER_COLOR:u?"var(--sapButton_BorderColor)":"#ccc",cleanup:function(){if(this.colors&&this.colors.length)for(var e=0;e<this.colors.length;++e)this.colors[e].cleanup();this.unregister()},renderHtml:function(e){this.btn.renderHtml(e),e.push("<div style='","background:",this._getOptToolbarBackground(),";","border:1px solid ",this._getOptToolbarBorderColor(),";","' class='nrte_color_div' id='",this.id,"'>","<ul class='nrte_color_ul' style='width:",22*this.colors.length+4,"px;' onmouseover='",this.fireCode("_over"),"' onmouseout='",this.fireCode("_out"),"'>");for(var t=0;t<this.colors.length;++t)e.push("<li style='border:none;display:inline;margin:0px;padding:0px;'>"),this.colors[t].renderHtml(e),e.push("</li>");e.push("</ul></div>")},_getOptToolbarBackground:function(){return this._optionsToolbar&&this._optionsToolbar.background?this._optionsToolbar.background:this._DEFAULT_BACKGROUND_COLOR},_getOptToolbarBorderColor:function(){return this._optionsToolbar&&this._optionsToolbar.border&&this._optionsToolbar.border.color?this._optionsToolbar.border.color:this._DEFAULT_BORDER_COLOR},_over:function(){this._tid&&(clearTimeout(this._tid),delete this._tid)},_out:function(){var e=this;this._tid=setTimeout(function(){e.hideDisplay()},500)},hideDisplay:function(){var e=juic.$(this.id);if(e){var t=e.style;t.display="none",SFDOMEvent.removeListener(window.document,"click",this.hideDisplay)}},showDisplay:function(){var e=juic.$(this.id);if(e){var t=e.style;t.display="block";var n=e.childNodes[0],o="link_icon_"+n.childNodes[0].firstChild.id;juic.$(o)&&juic.$(o).focus();var i=this;setTimeout(function(){"none"!=t.display&&SFDOMEvent.addListener(window.document,"click",i.hideDisplay,i)},10)}}}),juic.extend(RTEditor,SFDragResizer,{cleanup:function(){if(this._tb){var e=this._tb;e.bold&&e.bold.cleanup(),e.italic&&e.italic.cleanup(),e.underline&&e.underline.cleanup(),e.numbers&&e.numbers.cleanup(),e.bullets&&e.bullets.cleanup(),e.indent&&e.indent.cleanup(),e.outdent&&e.outdent.cleanup(),e.createLink&&e.createLink.cleanup(),e.textColor&&e.textColor.cleanup(),e.fontSize&&e.fontSize.cleanup(),e.spellCheck&&e.spellCheck.cleanup(),e.legalScan&&e.legalScan.cleanup(),e.waca&&e.waca.cleanup(),e.notebook&&e.notebook.cleanup()}this.unregister()},_DEFAULT_RTE_HEIGHT:200,_DEFAULT_RTE_BORDER_WIDTH:1,_DEFAULT_RTE_AUTOGROW_HEIGHT:200,_DEFAULT_TEXTPANE_BORDER_COLOR:"#ddd",_DEFAULT_TEXTPANE_BORDER_STYLE:u?"none":"solid",_DEFAULT_TEXTPANE_PADDING:5,_DEFAULT_TOOLBAR_BACKGROUND:u?"var(--sapToolbar_Background)":"#f3f3f3",_DEFAULT_TOOLBAR_BORDER_COLOR:"#ddd",_DEFAULT_TOOLBAR_BORDER_STYLE:"solid",_DEFAULT_TOOLBAR_BUTTON_HEIGHT:16,_DEFAULT_TOOLBAR_HEIGHT:29,_isLimiterDIVVisible:!1,_init:function(){function e(e,t,n){this.handleEvent=function(){a._execCommand(e,t,n),a._update(!0)}}function t(t,o,i,l,_,d,s){if(s)return null;var r={border:{color:a._getOptToolbarButtonsBorderColor()},disabled:!l},p=new n(t,o,i,r);return p.addEventListener("click",new e(l,_,d)),p}var a=this;this.register(),this.setOptions&&this.setOptions(this._options),this._options&&this._options.allowAutoGrow&&(this._allowAutoGrow=this._options.allowAutoGrow,this._autoGrow_minHeight=this._options.height?this._options.height:this._DEFAULT_RTE_HEIGHT,this._autoGrow_maxHeight=parseInt(this._autoGrow_minHeight)+this._DEFAULT_RTE_AUTOGROW_HEIGHT);var l=new SFDefaultSingleSelectModel([new SFSimpleSelectItem("3",MSGS.COMMON_RTE_TOOLBAR_TEXT_SIZE||"Size"),new SFSimpleSelectItem("1",MSGS.COMMON_RTE_TOOLBAR_TEXT_SIZE_EXTRA_SMALL||"XS"),new SFSimpleSelectItem("2",MSGS.COMMON_RTE_TOOLBAR_TEXT_SIZE_SMALL||"S"),new SFSimpleSelectItem("4",MSGS.COMMON_RTE_TOOLBAR_TEXT_SIZE_LARGE||"L"),new SFSimpleSelectItem("5",MSGS.COMMON_RTE_TOOLBAR_TEXT_SIZE_EXTRA_LARGE||"XL"),new SFSimpleSelectItem("6",MSGS.COMMON_RTE_TOOLBAR_TEXT_SIZE_DOUBLE_EXTRA_LARGE||"XXL"),new SFSimpleSelectItem("7",MSGS.COMMON_RTE_TOOLBAR_TEXT_SIZE_TRIPLE_EXTRA_LARGE||"XXXL")]);if(this._tb={bold:t(MSGS.COMMON_RTE_TOOLBAR_BOLD||"Bold",MSGS.COMMON_RTE_TOOLBAR_BOLD_DESC,"bold","bold"),italic:t(MSGS.COMMON_RTE_TOOLBAR_ITALIC||"Italic",MSGS.COMMON_RTE_TOOLBAR_ITALIC_DESC,"italic","italic"),underline:t(MSGS.COMMON_RTE_TOOLBAR_UNDERLINE||"Underline",MSGS.COMMON_RTE_TOOLBAR_UNDERLINE_DESC,"underline","underline"),numbers:t(MSGS.COMMON_RTE_TOOLBAR_NUMBERING||"Numbering",MSGS.COMMON_RTE_TOOLBAR_NUMBERING_DESC,"numbering","insertorderedlist"),bullets:t(MSGS.COMMON_RTE_TOOLBAR_BULLETS||"Bullets",MSGS.COMMON_RTE_TOOLBAR_BULLETS_DESC,"bullets","insertunorderedlist"),outdent:t(MSGS.COMMON_RTE_TOOLBAR_OUTDENT||"Outdent",MSGS.COMMON_RTE_TOOLBAR_OUTDENT_DESC,"outdent","outdent"),indent:t(MSGS.COMMON_RTE_TOOLBAR_INDENT||"Indent",MSGS.COMMON_RTE_TOOLBAR_INDENT_DESC,"indent","indent"),fontSize:new o(MSGS.COMMON_RTE_TOOLBAR_FONT_SIZE||"Font Size",MSGS.COMMON_RTE_TOOLBAR_FONT_SIZE_DESC,l,3,"fontSize",a),createLink:t(MSGS.COMMON_RTE_TOOLBAR_HYPERLINK||"Hyperlink",MSGS.COMMON_RTE_TOOLBAR_HYPERLINK_DESC,"hyperlink","createLink",!0),textColor:new i({border:{color:this._getOptToolbarButtonsBorderColor()}},this._getOptToolbarSub()),spellCheck:t(MSGS.COMMON_RTE_TOOLBAR_SPELL_CHECK||"Spell Check",MSGS.COMMON_RTE_TOOLBAR_SPELL_CHECK_DESC,"spellCheck",this._options&&this._options.spellCheck?"_popUpSpellCheck":null,null,null,this._options&&this._options.hideSpellCheck),legalScan:t(MSGS.COMMON_RTE_TOOLBAR_LEGAL_SCAN||"Legal Scan",MSGS.COMMON_RTE_TOOLBAR_LEGAL_SCAN_DESC,"legalScan",this._options&&this._options.legalScan?"_popUpLegalScan":null,null,null,this._options&&this._options.hideLegalScan),waca:t(MSGS.COMMON_RTE_TOOLBAR_WRITING_ASSISTANT||"Writing Assistant",MSGS.COMMON_RTE_TOOLBAR_WRITING_ASSISTANT_DESC,"writeAssistant",this._options&&this._options.waca?"_popUpWACA":null,null,null,this._options&&this._options.hideWaca),notebook:t(MSGS.COMMON_RTE_TOOLBAR_NOTEBOOK||"Notebook",MSGS.COMMON_RTE_TOOLBAR_NOTEBOOK_DESC,"notebook",this._options&&this._options.notebook?"_notebook":null)},this._maxLength=this._options.maxChars,this._maxLength)if(this._options.maxCharWarning="undefined"!=typeof this._options.maxCharWarning&&this._options.maxCharWarning,juic.assert(100<=this._maxLength,"maxchar cannot be less than 100"),this._maxLength=100<this._maxLength?this._maxLength:100,this._highlightOverflowTextMode=this._options.highlightOverflowTextMode,this._textLimiter=new SFTextLimiter(this._maxLength,!0,this.id,this._highlightOverflowTextMode),this._textLimiter.addEventListener("limiterAction",this,"_handleLimiterEvent"),this._textLimiter.checkLimiter(this.getValue()),this._highlightOverflowTextMode)this._update();else{var _=Util.isFioriEnabled()?150:100;this.textLimiterAutoTrim(),this._charLimitDialog=new SFDialog(MSGS.COMMON_Err,new SFSysMsg("alert",MSGS.get("COMMON_RTE_MAXIMUM_CHAR_LIMIT_MESSAGE",this._maxLength)),[{label:MSGS.COMMON_Ok,enabled:!0,active:!0,eventName:"done"}],400,_),this._pasteLimitDialog=new SFDialog(MSGS.COMMON_Err,new SFSysMsg("alert",MSGS.get("COMMON_RTE_MAXIMUM_PASTE_LIMIT_MESSAGE",this._maxLength)),[{label:MSGS.COMMON_Ok,enabled:!0,active:!0,eventName:"done"}],400,_),this._charLimitDialog.addEventListener("action",{handleEvent:function(e){a._dialogVisible=!1,a._resetValue(),"done"==e.actionCommand&&a._charLimitDialog.close()}}),this._pasteLimitDialog.addEventListener("action",{handleEvent:function(e){a._dialogVisible=!1,"done"==e.actionCommand&&a._pasteLimitDialog.close()}})}this._tb.textColor.addEventListener("color",{handleEvent:function(e){a._execCommand("forecolor",!1,e.color)}}),this._initResizer(this._options)},_initPanelDimensions:function(){this._options&&this._setPaneHeight(this._options),this._options.width&&(this._paneWidth=this._options.width)},_getEditorHeight:function(e){return e&&this._setPaneHeight(e),p?this._paneHeight-2*this._DEFAULT_TEXTPANE_PADDING:this._paneHeight},_setPaneHeight:function(e){e.height||(e.height=this._DEFAULT_RTE_HEIGHT),this._paneHeight=this.isReadOnly()||this.isToolbarHidden()?e.height-2*this._DEFAULT_RTE_BORDER_WIDTH:e.height-2*this._DEFAULT_RTE_BORDER_WIDTH-this._DEFAULT_TOOLBAR_HEIGHT},_initResizer:function(e){this._allowResize=!!e.allowResize,this._dimension=e.dimension||{},this._minDimensions=e.minDimensions||{},this._maxDimensions=e.maxDimensions||{}},setResizable:function(){},getResizable:function(){return this},setDimension:function(e){this._dimension=e,this._setStyles(e)},getDimension:function(){return this._getDimensions(),this._dimension},resize:function(){},getMinDimension:function(){if(!(this._minDimensions&&this._minDimensions.width)){var e=SFDom.getDefaultFontSize();this._minDimensions={width:"410",height:e[1]+27+14}}return this._minDimensions},getMaxDimension:function(){return this._maxDimensions},handleAfterRenderListener:function(){this._getDimensions(),this._dimension.width=this._fullWidth||this._dimension.width,this._setStyles(this._dimension)},_getDimensions:function(){var e=this.id+"_wrapper",t={};juic.$(e)&&(t=SFDom.getRegion(e)),this._dimension=t},_setStyles:function(e){var t=juic.$(this.id+"_wrapper"),n=SFDom.getStyle(t,"border-width");n=n?2*parseInt(n):0,SFDom.setStyle(t,"width",e.width-n+"px"),SFDom.setStyle(t,"height",e.height-n+"px");var o=this._getEditorHeight(e),i=juic.$(this.id+"_editor"),a=i?i:juic.$(this.id);a.style.height=o+"px"},getValue:function(){var e=juic.$(this.id);if(!e)return this._valueSet;if(p){var t=e.innerHTML;return t=t.replace(/^<br><\/br>|^<div><br><\/div>|^<br>/g,""),t}var t=e.contentDocument&&e.contentDocument.body&&e.contentDocument.body.innerHTML;return t&&t!=this._valueOriginal&&l?t=t.replace(/^<br><\/br>|^<div><br><\/div>|^<br>/g,""):r&&(t=e.value),t},getValueEscaped:function(){return this._txtEscQuotes(this._txtEscEntities(this.getValue()))},getValuePlain:function(){return this._txtUnEscEntities(this.getValue())},getValuePlainWithLinkBreaks:function(){return this._txtUnEscEntitiesWithLinkBreaks(this.getValue())},getValueStripped:function(){return this._txtTranslateHTML(this.getValue())},isReadOnly:function(){return this._options&&this._options.readOnly},isValueBlank:function(){var e=11<=Util.ieVersion(!0)?this.getValueStripped():this.getValuePlain();if(!e)return!0;var t=e.replace(/^(\s|\xA0)+|(\s|\xA0)+$/mg,"");return!t||0==t.length},hasValueChanged:function(){return this._valueOriginal!=this.getValue()},isToolbarHidden:function(){return this._options&&this._options.toolbar&&this._options.toolbar.hide},manuallyInit:function(){p||this._ifloaded||r||this._ifload()},setText:function(e){this.setValue(e)},setValue:function(e){this._setValueInternal(e)},_setValueInternal:function(e,t){this._valueSet=function(e){var t=document.createElement("div");return t.innerHTML=e||"",t.innerHTML}(e);var n=juic.$(this.id);if(n){if(p?n.innerHTML=this._valueSet:n.contentDocument&&n.contentDocument.body?n.contentDocument.body.innerHTML=this._valueSet:r&&(n.value=this._valueSet),this._options.name){var o=juic.$(this._options.name);o&&(o.value=this._valueSet)}!0!=t&&this._update()}},setValuePlain:function(e){this.setValue(this._txtEscEntities(e))},getEditorDocument:function(){var e,t=juic.$(this.id);return p?e=t:(e=t.contentWindow,e=e&&e.document||t.contentDocument),e},renderHtml:function(e){this._allowResize?this._super(e):this.renderContent(e)},_getA11yDescId:function(){var e;return e=this._useDefaultLabel?this._gname+"_RTEditorDesc":"rteditor508Desc",e},renderContent:function(e){function t(t){return t?_._paneWidth&&d+26+8>_._paneWidth?0:(d+=26,e.push("<div class='nrte_toolbar_button_li'>"),t.renderHtml(e),e.push("</div>"),1):0}function n(t){return _._paneWidth&&d+52+8>_._paneWidth?0:(d+=52,e.push("<div class='nrte_toolbar_button_li'>"),t.renderHtml(e),e.push("</div>"),1)}function o(){return _._paneWidth&&d+9+8>_._paneWidth?0:(d+=9,e.push("<div class='nrte_toolbar_sep_li'>|</div>"),1)}var i=this.id;if(r)return e.push("<div id=\"iPadMsg\">",MSGS.COMMON_RTE_NOT_SUPPORTED,"</div>"),void e.push("<textarea id=\"",i,"\" class=\"iPadRTE\" disabled>",this._valueSet,"</textarea>");var a=this._getA11yDescId();juic.$(a)||e.push("<span id='",a,"' class='hiddenAriaContent'>",this._label,"</span>");var l=this._tb,_=this,d=0;if(e.push("<div  id='",this.registerAutomationName(this.id+"_wrapper","RTEditor-"+this._gname),"' onclick='",this.fireCode("_eventClick"),"'"," onkeydown='",this.fireCode("_eventKeydown"),"'"," style='"),this._options.absolutePosition&&(e.push("position:absolute;"),this._options.absolutePosition.left&&e.push("left:",this._options.absolutePosition.left,"px;"),this._options.absolutePosition.top&&e.push("top:",this._options.absolutePosition.top,"px;")),e.push("height:",this._options.height-2*this._DEFAULT_RTE_BORDER_WIDTH,"px;"),e.push("border-width:1px;"),this._paneWidth&&e.push("width:",this._paneWidth-2*this._DEFAULT_RTE_BORDER_WIDTH,"px;"),this._getOptTextpaneBorderColor()&&e.push("border-color:",this._getOptTextpaneBorderColor(),";"),this._getOptTextpaneBorderStyle()&&e.push("border-style:",this._getOptTextpaneBorderStyle(),";"),e.push("' role='application' aria-labelledby='",a,"'>"),!this.isToolbarHidden()&&!this.isReadOnly()){e.push("<div class='nrte_toolbar_div' style='"),this._getOptToolbarBackground()&&e.push("background:",this._getOptToolbarBackground(),";"),this._getOptToolbarBorderColor()&&e.push("border-color:",this._getOptToolbarBorderColor(),";"),e.push("height:",this._DEFAULT_TOOLBAR_HEIGHT-this._DEFAULT_RTE_BORDER_WIDTH,"px;"),e.push("'>"),e.push("<div class='toolbarULDiv'>"),e.push("<div role='toolbar'"," unselectable='on' ondragstart='javascript:return 0'"," id='",i,"_toolbar' class='nrte_toolbar_div_ul'"),s?e.push(" onmousedown='",this.fireCode("_saveSelection"),"'"):10>=Util.ieVersion()?e.push(" onmousedown='",this.fireCode("_saveParentScrollTop"),"'"):e.push(" onmousedown='javascript:return 0'"),e.push(">"),t(l.bold)&&t(l.italic)&&t(l.underline)&&o()&&t(l.numbers)&&t(l.bullets)&&t(l.outdent)&&t(l.indent)&&o()&&t(l.createLink)&&o()&&t(l.textColor)&&n(l.fontSize)&&o();var u=!1;t(l.spellCheck)&&(u=!0),t(l.legalScan)&&(u=!0),t(l.waca)&&(u=!0),this._options&&this._options.notebook&&t(l.notebook)&&(u=!0),u&&o();var c="RTEditor.attachTBBtnEvent('"+i+"_toolbar')";e.push("</div>"),e.push("</div>"),e.push("<img src=\""+IMAGES["/ui/juic/img/_.gif"]+"\" onerror=\"",c,"\"  onload=\"",c,"\" style=\"width:0;height:0;\"/></div>")}if(p){var h="nrte_showScrollbar";s&&(h+=" nrte_content_webkit"),e.push("<div class='nrte_contentArea ",h,"' style='padding:",this._DEFAULT_TEXTPANE_PADDING,"px;"),this._getOptTextpaneBackground()&&e.push("background:",this._getOptTextpaneBackground(),";"),this._paneHeight&&e.push("height:",this._getEditorHeight(),"px;"),s&&(this._getOptTextpaneFontFamily()&&e.push("font-family:",this._getOptTextpaneFontFamily(),";"),this._getOptTextpaneFontSize()&&e.push("font-size:",this._getOptTextpaneFontSize(),";")),e.push("'"," onclick='",this.fireCode("_eventClickTextPane"),"'"),s?e.push(" id='",i,"'"):(e.push(" id='",i,"_editor'>","<div class=\"nrte_content\" id='",i,"' style='"),this._getOptTextpaneFontFamily()&&e.push("font-family:",this._getOptTextpaneFontFamily(),";"),this._getOptTextpaneFontSize()&&e.push("font-size:",this._getOptTextpaneFontSize(),";"),e.push("'")),e.push(" aria-labelledby='",a,"'"),this.isReadOnly()||e.push(" contenteditable='true'"),e.push(" onblur='",this.fireCode("_blur"),"'"," onkeyup='",this.fireCode("_keyup"),"'"," ondblclick='",this.fireCode("_update"),"'"," onmouseup='",this.fireCode("_update"),"'"," onpaste='",this.fireCode("_paste"),"'"," oncut='",this.fireCode("_update"),"'"," onfocus='",this.fireCode("_focus"),"'",">",this._valueSet,"</div>"),s||e.push("</div>")}else e.push("<iframe id='",i,"' style='"),this._paneHeight&&e.push("height:",this._getEditorHeight(),"px;"),e.push("width:100%;"),e.push("-moz-box-sizing:border-box;"),e.push("border:0px; '"),this._options&&this._options.manuallyInit||e.push(" onload='",this.fireCode("_ifload"),"'"),e.push(" title='",this._label,"'"),e.push(" src='javascript:\"loading...\";'>"),e.push("</iframe>");this._options.name&&e.push("<input type='text' style='display: none;' id='",this._options.name,"' name='",this._options.name,"' value='",this._valueSet.replace(/&/g,"&amp;").replace(/\'/g,"&#39;").replace(/</g,"&lt;"),"'>"),this._textLimiter&&(e.push("<div id=\"",this.id,"_counter\" class=\"nrte_char_textLimiter nrte_char_hideLimiter\" >"),this._textLimiter.renderHtml(e),e.push("</div><div class=\"nrte_clearDiv\"></div>")),e.push("</div>")},_updateHiddenInput:function(){this._options.name&&(juic.$(this._options.name).value=this.getValue())},_blur:function(){this._hideTextLimiter(),this._updateHiddenInput(),this.dispatch("blur")},_eventClick:function(){this.dispatch("click")},_eventKeydown:function(e){var t=SFDOMEvent.KEY_CODE;(e.keyCode==t.RETURN||e.keyCode==t.SPACE)&&this.dispatch("click")},_eventClickTextPane:function(){if(!s){var e=document.activeElement;e&&e.id&&e.id==this.id||this._refocus()}this._tb.textColor.hideDisplay()},_eventClickIFrame:function(){this._eventClickTextPane(),this._eventClick(),this.dispatch("clickIFrame")},_execCommand:function(e,t,n){if("_popUpSpellCheck"==e)return this._popUpSpellCheck();if("_popUpLegalScan"==e)return this._popUpLegalScan();if("_popUpWACA"==e)return this._popUpWACA();if("_notebook"==e)return this._notebook();var o=document.activeElement;if(o&&o.id&&o.id==this.id||this._refocus(),t&&"createLink"==e&&(!Util.ieVersion(!0)||Util.browserInfo.edge)){var i,a=juic.$(this.id);p?i=window.getSelection():(a=a.contentDocument,i=a.getSelection());var l=MSGS.COMMON_RTE_HYPERLINK_HTTP;if(i&&i.focusNode){var _=i.focusNode;if(Util.browserInfo.edge)for(;_.childNodes&&_.childNodes[0];)_=_.childNodes[0];if(SFDom.isAncestor(a,_))for(;_.parentNode&&_.parentNode!=a;){if("a"==_.parentNode.tagName.toLowerCase()){l=_.parentNode.getAttribute("href");break}_=_.parentNode}}if(n=prompt(MSGS.COMMON_RTE_HYPERLINK_URL,l),!n)return;var d=/^(https?:)?\/\/.*/i,s=d.exec(n);null==s&&(n=MSGS.COMMON_RTE_HYPERLINK_HTTP+n),t=!1}p?document.execCommand(e,t,n):juic.$(this.id).contentDocument.execCommand(e,t,n);var r=this._checkCount();r||this._update()},_getBackPosLegalScan:function(){return this._options&&this._options.legalScan?-(18*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT):-(19*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT)},_getBackPosNotebook:function(){return this._options&&this._options.notebook?-(23*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT):-(24*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT)},_getBackPosSpellCheck:function(){return this._options&&this._options.spellCheck?-(16*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT):-(17*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT)},_getBackPosWACA:function(){return this._options&&this._options.waca?-(20*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT):-(21*this._DEFAULT_TOOLBAR_BUTTON_HEIGHT)},_getOptTextpaneBorderColor:function(){return this._options&&this._options.textpane&&this._options.textpane.border&&this._options.textpane.border.color?this._options.textpane.border.color:this._DEFAULT_TEXTPANE_BORDER_COLOR},_getOptTextpaneBorderStyle:function(){return this._options&&this._options.textpane&&this._options.textpane.border&&this._options.textpane.border.style?this._options.textpane.border.style:this._DEFAULT_TEXTPANE_BORDER_STYLE},_getOptTextpaneBackground:function(){return this._options&&this._options.textpane&&this._options.textpane.background?this._options.textpane.background:null},_getOptTextpaneFontFamily:function(){return this._options&&this._options.textpane&&this._options.textpane.fontFamily},_getOptTextpaneFontSize:function(){return this._options&&this._options.textpane&&this._options.textpane.fontSize},_getOptToolbarBackground:function(){return this._options&&this._options.toolbar&&this._options.toolbar.background?this._options.toolbar.background:this._DEFAULT_TOOLBAR_BACKGROUND},_getOptToolbarBorderColor:function(){return this._options&&this._options.toolbar&&this._options.toolbar.border&&this._options.toolbar.border.color?this._options.toolbar.border.color:this._DEFAULT_TOOLBAR_BORDER_COLOR},_getOptToolbarBorderStyle:function(){return this._options&&this._options.toolbar&&this._options.toolbar.border&&this._options.toolbar.border.style?this._options.toolbar.border.style:this._DEFAULT_TOOLBAR_BORDER_STYLE},_getOptToolbarButtonsBorderColor:function(){return this._options&&this._options.toolbar&&this._options.toolbar.buttons&&this._options.toolbar.buttons.border&&this._options.toolbar.buttons.border.color?this._options.toolbar.buttons.border.color:null},_getOptToolbarSub:function(){return this._options&&this._options.toolbar&&this._options.toolbar.sub?this._options.toolbar.sub:null},_ifload:function(){var t=juic.$(this.id).contentDocument;if(t.body.innerHTML=this._valueSet,this.isReadOnly()||t.body.setAttribute("contenteditable","true"),Util.isRTL()&&t.body.setAttribute("dir","rtl"),t.body.style.padding=""+this._DEFAULT_TEXTPANE_PADDING+"px",t.body.style.margin="0px","dark"==AccessibilityPrefs.getLowVisionType()&&(t.body.style.color="#ffffff"),this._getOptTextpaneBackground()&&(t.body.style.background=this._getOptTextpaneBackground()),this._getOptTextpaneFontFamily()&&(t.body.style.fontFamily=this._getOptTextpaneFontFamily()),this._getOptTextpaneFontSize()&&(t.body.style.fontSize=this._getOptTextpaneFontSize()),t.addEventListener("click",e(this,this._eventClickIFrame),!1),!this.isReadOnly()){try{t.designMode="on";try{t.execCommand("styleWithCSS",0,!1)}catch(n){try{t.execCommand("useCSS",0,!0)}catch(n){try{t.execCommand("styleWithCSS",!1,!1)}catch(t){}}}}catch(t){throw t}var n=this;t.addEventListener("blur",e(this,this._blur),!0),t.addEventListener("keydown",function(e){function t(t){!e.ctrlKey||e.shiftKey||e.altKey||e.metaKey||(juic.$(n.id).contentDocument.execCommand(t,!1,null),e.preventDefault(),e.stopPropagation())}switch(e.keyCode){case 9:if(e.preventDefault(),!e.shiftKey){for(var o=document.body,i=n._getRTEParentNode(),a=i.nextSibling;!a&&(i=i.parentNode,i&&i!=o);)a=i.nextSibling;var l=a?SFDom.findNextFocusableElement(a,o,!0,!1):null;if(l&&l.focus)try{l.focus()}catch(t){l=null}l||o.focus()}else if(n._tb){var _=n._tb;_.waca?juic.$("link_icon_"+_.waca.id).focus():_.legalScan?juic.$("link_icon_"+_.legalScan.id).focus():_.spellCheck?juic.$("link_icon_"+_.spellCheck.id).focus():_.fontSize?juic.$(_.fontSize.dropdown.id).focus():_.textColor?juic.$("link_icon_"+_.textColor.id).focus():_.createLink?juic.$("link_icon_"+_.createLink.id).focus():_.outdent?juic.$("link_icon_"+_.outdent.id).focus():_.indent?juic.$("link_icon_"+_.indent.id).focus():_.bullets?juic.$("link_icon_"+_.bullets.id).focus():_.numbers?juic.$("link_icon_"+_.numbers.id).focus():_.underline?juic.$("link_icon_"+_.underline.id).focus():_.italic?juic.$("link_icon_"+_.italic.id).focus():_.bold&&juic.$("link_icon_"+_.bold.id).focus()}else try{juic.$(n.id).focus()}catch(t){}break;case 66:t("bold");break;case 73:t("italic");break;case 85:t("underline");}},!0),t.addEventListener("keyup",e(this,this._keyup),!0),t.addEventListener("mouseup",e(this,this._update),!0),t.addEventListener("paste",e(this,this._paste),!0),t.addEventListener("cut",e(this,this._update),!0),t.addEventListener("focus",e(this,this._focus),!0),this._ifloaded=!0}},_getRTEParentNode:function(){var e=juic.$(this.id+"_wrapper").parentNode;return this._allowResize&&(e=e.parentNode),e},_focus:function(){this._textLimiter&&(this._textLimiter.checkLimiter(this.getValue()),this._showTextLimiter()),this._allowAutoGrow&&this._resizeForAutoGrow(),this.dispatch("focus")},_notebook:function(){juic.assert(this._options&&this._options.notebook,"Notebook configuration not specified."),this._options.notebook.event&&this.dispatch(this._options.notebook.event)},_secureForm:function(e){return e+"_s.crb="+ajaxSecKey},_popUpSpellCheck:function(){var e=this.getValueEscaped(),t=[];t.push("<html>\n"),t.push("<head>\n"),t.push("<meta http-equiv='Content-Type' content='text/html; charset=utf-8'>\n"),t.push("</head>\n"),t.push("<body>\n"),t.push("<font face='arial, helvetica' size=2>",RTEditor.msgs.COMMON_RTE_SPELL_CHECK_DOCUMENT,"</font>\n"),t.push("<form action='"+this._secureForm("/ui/uicore/pages/rapidspellcheck?")+"' method='post' ACCEPT-CHARSET='UTF-8'>\n"),t.push("<input type='hidden' name='textToCheck' value=\""),t.push(e),t.push("\">\n"),t.push("<input type='hidden' name='InterfaceObject' value='"),t.push(this._gname),t.push("'>\n"),t.push("<input type='hidden' name='mode' value='popup'>\n"),t.push("<input type='hidden' name='UserDictionaryFile' value=''>\n"),t.push("<input type='hidden' name='SuggestionsMethod' value='HASHING_SUGGESTIONS'>\n"),t.push("<input type='hidden' name='SeparateHyphenWords' value='true'>\n"),t.push("<input type='hidden' name='IncludeUserDictionaryInSuggestions' value='true'>\n"),t.push("<input type='hidden' name='FinishedListener' value=''>\n"),t.push("<input type='hidden' name='callBack' value=''>\n"),t.push("<input type='hidden' name='IgnoreXML' value='true'>\n"),t.push("<input type='hidden' name='IgnoreCapitalizedWords' value='false'>\n");var n=window.localeForRapidSpellWeb?window.localeForRapidSpellWeb:window.userSelectedLanguage?window.userSelectedLanguage:"ENGLISH";t.push("<input type='hidden' name='GuiLanguage' value='"),t.push(n),t.push("'>\n"),t.push("<input type='hidden' name='LanguageParser' value='"),t.push(n),t.push("'>\n"),t.push("<input type='hidden' name='Modal' value='false'>\n"),t.push("<input type='hidden' name='AllowAnyCase' value='false'>\n"),t.push("<input type='hidden' name='IgnoreWordsWithDigits' value='false'>\n"),t.push("<input type='hidden' name='ShowFinishedMessage' value='true'>\n"),t.push("<input type='hidden' name='ShowNoErrorsMessage' value='true'>\n"),t.push("<input type='hidden' name='ShowXMLTags' value='false'>\n"),t.push("<input type='hidden' name='AllowMixedCase' value='false'>\n"),t.push("<input type='hidden' name='WarnDuplicates' value='true'>\n"),t.push("<input type='hidden' name='DictFile' value=''>\n"),t.push("<input type='hidden' name='PopUpWindowName' value=''>\n"),t.push("<input type='hidden' name='CreatePopUpWindow' value='true'>\n"),t.push("<input type='hidden' name='ConsiderationRange' value='80'>\n"),t.push("<input type='hidden' name='UseUpdate' value='false'>\n"),t.push("<input type='hidden' name='LookIntoHyphenatedText' value='true'>\n"),t.push("<input type='hidden' name='CheckCompoundWords' value='false'>\n"),t.push("<input type='hidden' name='EnableUndo' value='true'>\n"),t.push("<input type='hidden' name='LeaveWindowOpenForUndo' value='false'>\n"),t.push("<input type='hidden' name='FinishClosesWindow' value='true'>\n"),t.push("</form>\n"),t.push(a()),t.push("</body>\n"),t.push("</html>\n"),this._popUpWin("rspellnwin","spell checker",t.join(""),{width:Util.browserInfo.edge?550:470,height:525})},_popUpLegalScan:function(){var e=this.getValueEscaped(),t=[];t.push("<html>\n"),t.push("<head>\n"),t.push("<meta http-equiv='Content-Type' content='text/html; charset=utf-8'>\n"),t.push("</head>\n"),t.push("<body>\n"),t.push("<font face='arial, helvetica' size=2>",RTEditor.msgs.COMMON_RTE_SCANNING_DOCUMENT,"</font>\n"),t.push("<form action='"+this._secureForm("/legalscan?")+"' method='post' ACCEPT-CHARSET='UTF-8'>\n"),t.push("<input type='hidden' name='lscn_param_fieldvalue' value=\""),t.push(this._txtEscQuotes(e)),t.push("\">\n"),t.push("</form>\n"),t.push(a()),t.push("</body>\n"),t.push("</html>\n"),this._popUpWin("legalscanwin","legal scanner",t.join(""))},_popUpWACA:function(){juic.assert(this._options&&this._options.waca,"Writing assistant configuration not specified.");var e=this.getValueEscaped(),t=[];t.push("<html>\n"),t.push("<head>\n"),t.push("<meta http-equiv='Content-Type' content='text/html; charset=utf-8'>\n"),t.push("</head>\n"),t.push("<body>\n"),t.push("<font face='arial, helvetica' size=2>",RTEditor.msgs.COMMON_RTE_INIT_WACA_DOCUMENT,"</font>\n"),t.push("<form action='"+this._secureForm("/handbook?")+"' method='post' ACCEPT-CHARSET='UTF-8'>\n"),t.push("<input type='hidden' name='hbpge_param_hbnavtab' value='hb_all'>\n"),t.push("<input type='hidden' name='hbpge_sh_wri' value='true'>\n"),t.push("<input type='hidden' name='hbpge_sh_coa' value='true'>\n"),this._options.waca.competencyId&&t.push("<input type='hidden' name='hball_param_compid' value='",this._options.waca.competencyId,"'>\n"),t.push("<input type='hidden' name='hball_param_complocale' value='",this._options.waca.competencyLocale?this._options.waca.competencyLocale:"en_US","'>\n"),this._options.waca.employeeId&&t.push("<input type='hidden' name='hbpge_param_sub_id' value='",this._options.waca.employeeId,"'>\n"),t.push("<input type='hidden' name='rte' value='true'>\n"),t.push("<input type='hidden' name='fbwaca_param_rte_gname' value='"),t.push(this._gname),t.push("'>\n"),t.push("<input type='hidden' name='fbwaca_param_rte_sufx' value='<br><br>'>\n"),t.push("</form>\n"),t.push(a()),t.push("</body>\n"),t.push("</html>\n"),this._popUpWin("wacawin","writing assistant",t.join(""),{width:740,height:580})},_popUpWin:function(e,t,n,o){var i=370,a=430;null!=o&&null!=o.width&&(i=o.width),null!=o&&null!=o.height&&(a=o.height);var l=this._rsw_create_popup_window("/ui/uicore/pages/blank.html",e,"resizable=yes,scrollbars=yes,dependent=yes,toolbar=no,left=100,top=100,status=no,location=no,menubar=no,width="+i+",height="+a);l?(l.focus(),l.document.open(),l.document.write(n),l.document.close()):alert("The "+t+" popup has been blocked, most likely by a popup blocker.")},_refocus:function(){var e=juic.$(this.id);if(!p)e.contentWindow.focus();else if(e.focus(),10>=Util.ieVersion()&&this._parentScrollTop){var t=this;setTimeout(function(){e.parentNode.scrollTop=t._parentScrollTop,delete t._parentScrollTop},1)}if(this._savedRange){var n=window.getSelection();n.removeAllRanges(),n.addRange(this._savedRange),delete this._savedRange}},_rsw_create_popup_window:function(e,t,n){var o;if(window.showModelessDialog){var i;try{i=window.dialogArguments||window.opener,i&&i!=window&&!i.closed&&(o=i.open(e,t,n),o&&(o.opener=window))}catch(t){i=null}i||(o=window.open(e,t,n),o.opener=window)}else o=window.open(e,t,n);return o},_saveParentScrollTop:function(){this._parentScrollTop=juic.$(this.id).parentNode.scrollTop},_saveSelection:function(){var e=this,t=juic.$(e.id);if(t){var n=p?window:t.contentWindow,o=n.document,i=p?t:o.body;if(window.getSelection&&document.createRange){var a;if(!s)a=n.getSelection().getRangeAt(0);else try{var l=n.getSelection();l.rangeCount&&l.getRangeAt&&(a=l.getRangeAt(0),a&&(l.removeAllRanges(),l.addRange(a)))}catch(t){return{start:0,end:0}}this._savedRange=a;var _=a.cloneRange();_.selectNodeContents(i),_.setEnd(a.startContainer,a.startOffset);var d=_.toString().length;return{start:d,end:d+a.toString().length}}var r=document.selection.createRange(),u=document.body.createTextRange();u.moveToElementText(i),u.setEndPoint("EndToStart",r);var c=u.text,h=c.match(/\r\n/g),d=c.length-(h?h.length:0);return{start:d,end:d+r.text.length}}},_restoreSelection:function(e,t){var n=this,o=juic.$(n.id);if(o){var a=p?window:o.contentWindow,l=a.document,_=p?o:l.body;if(window.getSelection&&document.createRange){var d=0,s=document.createRange();s.setStart(_,0),s.collapse(!0);for(var r,u=[_],c=!1,h=!1;!h&&(r=u.pop());)if(3==r.nodeType){var T=d+r.length;!c&&e.start>=d&&e.start<=T&&(e.start==T&&t||(s.setStart(r,e.start-d),c=!0)),c&&e.end>=d&&e.end<=T?(s.setEnd(r,e.end-d),h=!0):c&&0==u.length&&(s.setEnd(r,T-d),h=!0),d=T}else for(var g=r.childNodes.length;g--;)u.push(r.childNodes[g]);var O=p?window.getSelection():juic.$(this.id).contentWindow.getSelection();O.removeAllRanges(),O.addRange(s)}else{var m=document.body.createTextRange();m.moveToElementText(_),m.collapse(!0);var E=e.start,L=e.end;try{t&&(e.end==e.start&&e.start++,e.end++),m.moveEnd("character",e.end),m.moveStart("character",e.start),m.select()}catch(t){m.moveEnd("character",E),m.moveStart("character",L),m.select()}}}},_togglePalette:function(){var e=juic.$(this.id+"pal").style;e.display=""==e.display?"block":""},_txtEscQuotes:function(e){if(!e)return null;var t=/"/g;return e.replace(t,"&#34;")},_txtEscEntities:function(e){var t=String.fromCharCode;if(!e)return null;var n=/&/g;e=e.replace(n,"&amp;");for(var o=161;255>=o;o++)n=new RegExp(t(o),"g"),e=e.replace(n,"&#"+o+";");return e},_txtTranslateHTML:function(e){if(!e)return null;var t=document.createElement("div");return t.innerHTML=e,SFDom.text(t)},_txtUnEscEntitiesWithLinkBreaks:function(e){return e?(e=e.replace(/\r/g,"").replace(/\n/g,""),e=e.replace(/<div(\s+((\"([^\"\\]|\\.)*\"|\'([^\'\\]|\\.)*\'|[^>\'\"])*))?>(.*?)<\/\s*div>/gi,"\n$6"),e=e.replace(/<li(\s+((\"([^\"\\]|\\.)*\"|\'([^\'\\]|\\.)*\'|[^>\'\"])*))?>(.*?)<\/\s*li>/gi,"\n$6\n"),e=e.replace(/<br(\s+((\"([^\"\\]|\\.)*\"|\'([^\'\\]|\\.)*\'|[^>\'\"])*))?>/gi,"\n"),e=e.replace(/<p(\s+((\"([^\"\\]|\\.)*\"|\'([^\'\\]|\\.)*\'|[^>\'\"])*))?>(.*?)<\/\s*p>/gi,"\n$6\n\n"),e=e.replace(/<p(\s+((\"([^\"\\]|\\.)*\"|\'([^\'\\]|\\.)*\'|[^>\'\"])*))?>/gi,"\n\n"),e=e.replace(/<(\"([^\"\\]|\\.)*\"|\'([^\'\\]|\\.)*\'|[^>\'\"])*>/g,""),this._txtUnEscEntities(e)):null},_txtUnEscEntities:function(e){if(!e)return null;var t=function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.childNodes[0].nodeValue;return t.removeChild(t.firstChild),n},n=e.match(/&(.*?);/g);if(n&&n.length)for(var o,i=0;i<n.length;++i)if(o=n[i],o){var a=new RegExp(o,"g");e=e.replace(a,t(o))}return e},_keyup:function(e){var t=this._options.bubbleUpdateEventOnKeyup||!1;if(!e)this._updateHiddenInput(),this._update(t);else if(e.ctrlKey||this._ctrlKeyPressedEarlier);else{var n=SFDOMEvent.KEY_CODE;switch(e.keyCode){case n.CTRL:case n.ARROW_LEFT:case n.ARROW_UP:case n.ARROW_RIGHT:case n.ARROW_DOWN:break;default:this._updateHiddenInput(),this._update(t,e),this._pasteValue=null;}}this._allowAutoGrow&&this._resizeForAutoGrow()},_resizeForAutoGrow:function(){var e=this._DEFAULT_TOOLBAR_HEIGHT,t=2*this._DEFAULT_RTE_BORDER_WIDTH,n=2*this._DEFAULT_TEXTPANE_PADDING,o=juic.$(this.id+"_wrapper"),i=juic.$(this.id+"_editor");if(i||(i=juic.$(this.id)),p){SFDom.replaceClass(i,"nrte_showScrollbar","nrte_hideScrollbar");var a=i.scrollHeight+e+t;a<this._autoGrow_maxHeight?o.style.height=a-t+"px":(o.style.height=this._autoGrow_maxHeight-t+"px",SFDom.replaceClass(i,"nrte_hideScrollbar","nrte_showScrollbar")),i.style.height=parseInt(o.style.height)-e-n+"px"}else{var a=i.contentDocument.body.scrollHeight+e+t;i.contentDocument.body.style.overflow="hidden",a<this._autoGrow_maxHeight?o.style.height=a-t+"px":(o.style.height=this._autoGrow_maxHeight-t+"px",i.contentDocument.body.style.overflow="auto"),i.style.height=parseInt(o.style.height)-e+"px"}},_update:function(e,t){if(!r&&!this.isReadOnly()&&(p||this._ifloaded)){var n=juic.$(this.id),o=this._tb;if(!e||(n&&(n=p?document:n.contentDocument,o.bold.setActive(n.queryCommandState("bold")),o.italic.setActive(n.queryCommandState("italic")),o.underline.setActive(n.queryCommandState("underline")),o.numbers.setActive(n.queryCommandState("insertorderedlist")),o.bullets.setActive(n.queryCommandState("insertunorderedlist")),o.fontSize.setValue(n.queryCommandValue("fontSize"))),this.dispatch("change")),this._textLimiter)if(this._highlightOverflowTextMode){if(7<=Util.ieVersion()){var i=this;if(t&&"dblclick"==t.type)return void(i.isDoubleClick=!0);if(t&&"mouseup"==t.type){if(i.isDoubleClick)return void(i.isDoubleClick=!1);i.isDoubleClick=!1}}var a=this._removeHighlightStyles(this.getValue()),l=this._textLimiter.getCheckLimiterObject(a);if(l.actionCommand==SFTextLimiter.ABOVE_MAXLENGTH||l.actionCommand==SFTextLimiter.AT_MAXLENGTH){if(10>Util.ieVersion());else{var _=this._saveSelection();this._setValueInternal(a,!0);var d=this._options.maxChars,s=a.length;if(!(window.getSelection&&document.createRange)){var u=this._txtUnEscEntities(a),c=u.length;s>c&&(s=c,d>s&&(d=s))}this._addHighlightStyles(d,s)}if(10>Util.ieVersion());else{var h=t&&(t.keyCode==SFDOMEvent.KEY_CODE.RETURN||t.keyCode==SFDOMEvent.KEY_CODE.ARROWDOWN);this._restoreSelection(_,h)}}this._textLimiter._updateView(l)}else this._textLimiter.checkLimiter(this.getValue())}},isOverTextCountLimit:function(){if(this._textLimiter&&this._highlightOverflowTextMode){var e=this._removeHighlightStyles(this.getValue()),t=this._textLimiter.getCheckLimiterObject(e);if(t.actionCommand==SFTextLimiter.ABOVE_MAXLENGTH)return!0}return!1},textLimiterAutoTrim:function(e){if(this._textLimiter&&this._maxLength&&this._textLimiter.getByteLength(this.getValue())>this._maxLength){var t=10,n=10;do this._setValueInternal(this.getValue().slice(0,this._maxLength-1-n)),n+=10;while(this._textLimiter.getByteLength(this.getValue())>this._maxLength);var o=this.getValue();if(this._prevValue=o,!e&&this._options.name){var i=juic.$(this._options.name);i&&(i.value=o)}}},_removeHighlightStyles:function(e){return e.replace(/<span\sstyle=\"background-color:\srgb\(255\,\s204\,\s204\)\;\">(.*?)<\/span>/gi,"$1").replace(/<font\sstyle=\"background-color:\srgb\(255\,\s204\,\s204\)\;\">(.*?)<\/font>/gi,"$1").replace(/<font\sstyle=\"background-color:\s#fcc*\">(.*?)<\/font>/gi,"$1")},_addHighlightStyles:function(e,t,n){var o=n?n:RTEditor.DEFAULT_HIGHLIGHT_BG_COLOR,i=juic.$(this.id);this._restoreSelection({start:e,end:t}),window.getSelection&&document.createRange?l?juic.$(this.id).contentDocument.execCommand("hiliteColor",!1,o):document.execCommand("backColor",!1,o):document.execCommand("backColor",!1,o)},_showTextLimiter:function(){this._highlightOverflowTextMode?this._textLimiter.show():this._isLimiterDIVVisible&&this._textLimiter.show()},_hideTextLimiter:function(){if(this._highlightOverflowTextMode){var e=!1;this._checkCount(!1)&&this._textLimiter.hide()}else this._isLimiterDIVVisible&&this._textLimiter.hide()},_handleLimiterEvent:function(e){if(!this._highlightOverflowTextMode){var t=juic.$(this.id+"_counter");if(this._isLimiterDIVVisible=!1,e.actionCommand==SFTextLimiter.BELOW_THRESHOLD)this._prevValue=this.getValue(),this._textLimiter.hide();else{if(e.actionCommand!=SFTextLimiter.ABOVE_MAXLENGTH)e.actionCommand==SFTextLimiter.AT_MAXLENGTH?(this._isLimiterDIVVisible=!0,this._prevValue=this.getValue()):(this._isLimiterDIVVisible=!0,this._prevValue=this.getValue());else if(this._setValueInternal(this._prevValue),!this._dialogVisible)if(!!this._options.maxCharWarning)this._pasteValue&&(this._dialogVisible=!0,juic.$(this.id)&&juic.$(this.id).blur(),this._pasteValue=null,this._pasteLimitDialog.showDialog(this.id));else if(this._dialogVisible=!0,juic.$(this.id)&&juic.$(this.id).blur(),this._pasteValue&&this._pasteValue.length>this._maxLength){var n=10;do this._setValueInternal(this._pasteValue.slice(0,this._maxLength-1-n),!0),n+=10;while(this._textLimiter.getByteLength(this.getValue())>this._maxLength);this._pasteValue=null,this._pasteLimitDialog.showDialog(this.id)}else this._charLimitDialog&&this._charLimitDialog.showDialog(this.id);this._showTextLimiter()}}},_resetValue:function(){this._textLimiter&&this._textLimiter.checkLimiter(this.getValue())},_checkCount:function(e){if(!this._textLimiter)return!0;var t=this._removeHighlightStyles(this.getValue());this._textLimiter.checkLimiter(t);var n=this._textLimiter.getByteLength(t);return!!(this._textLimiter&&(e?n<=this._maxLength:n<this._maxLength))},_paste:function(){var e=this,t=juic.$(e.id);this._ctrlKeyPressedEarlier=!0,setTimeout(function(){e._ctrlKeyPressedEarlier=!1},50),setTimeout(function(){if(e._pasteValue=e.getValue(),e._textNeedsCleaningUp(e._pasteValue)){var t=!0;e._options.cleanUpTextOnPasteConfirm&&(t=confirm(MSGS.get("COMMON_RTE_PASTE_FROM_WORD_DEFAULT"))),t&&(e._pasteValue=e._cleanUpPastedText(e._pasteValue),e._setValueInternal(e._pasteValue))}e._update()},1)},_textNeedsCleaningUp:function(e){return /(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/.test(e)},_wordListToHTMLList:function(e){for(var t,n="",o=[],i="none",a=0;e.substring(a,e.length).match(/<p[^>]*mso-list\:[\s\S]+?<\/p>/mi);){t=e.substring(a,e.length).match(/<p[^>]*mso-list\:[\s\S]+?<\/p>/mi);var l=t[0],_=a+e.substring(a,e.length).indexOf(l),d=_+l.length,s=l.match(/\s*font-family\:\s*Symbol\s*/im)&&1===l.match(/\s*font-family\:\s*Symbol\s*/im).length?"ul":"ol",r="<li>",p="</li>";("none"===i||s!==i)&&(r="ul"===s?"<ul>"+r:"<ol>"+r,i=s),l=l.replace(/<p[^>]*mso-list\:[\s\S]+?>(.*)<\/p>/ig,"$1"),9>Util.ieVersion()&&(l=l.replace(/<span[^>]*mso-list\:[\s\S]+?>[\s\S]+?<\/span>/gi,"")),l=l.replace(/<\/span>+/gi,""),l=l.replace(/<span([^>]*)>/gi,""),o.push({start:_,end:d,originalContent:l,newTagStart:r,newTagEnd:p,type:s}),a=d}a=0;for(var u=0;u<o.length;u++)n+=e.substring(a,o[u].start)+o[u].newTagStart+o[u].originalContent+o[u].newTagEnd,o[u+1]&&o[u+1].type!==o[u].type&&(n+="</"+o[u].type+">"),a=o[u].end;return 0<u&&(n+="</"+o[u-1].type+">"),n+=e.substring(a,e.length),n},_cleanUpPastedText:function(e){var t=e;Util.browserInfo.ie11plus||(t=this._wordListToHTMLList(e)),t=t.replace(/<img[^>]+>/gi,""),t=t.replace(/<w:[^>]*>[^>]*<\/w:[^>]*>/gi,""),t=t.replace(/<o:[^>]*>[^>]*<\/o:[^>]*>/gi,""),t=t.replace(/<style>(.*?)<\/style>/gi,""),t=t.replace(/<style>[^>]*<\/style>/gi,""),t=t.replace(/<!--[^>]*-->/gi,""),t=t.replace(/\<\!--\[if gte mso[^>]*\]\>/gi,""),t=t.replace(/\<\!--\[if \!mso\]\>/gi,""),t=t.replace(/\<\!\[endif\]--\>/gi,""),t=t.replace(/\<\!+--*\[endif\]--\>/gi,""),t=t.replace(/\<\!+--*\[endif\]----\>/gi,""),t=t.replace(/<o:p>\s*<\/o:p>/g,""),t=t.replace(/<o:p>.*?<\/o:p>/g,"&nbsp;"),t=t.replace(/\s*mso-[^:]+:[^;"]+;?/gi,""),t=t.replace(/\s*MARGIN: 0cm 0cm 0pt\s*;/gi,""),t=t.replace(/\s*MARGIN: 0cm 0cm 0pt\s*"/gi,"\""),t=t.replace(/\s*TEXT-INDENT: 0cm\s*;/gi,""),t=t.replace(/\s*TEXT-INDENT: 0cm\s*"/gi,"\""),t=t.replace(/\s*TEXT-ALIGN: [^\s;]+;?"/gi,"\""),t=t.replace(/\s*PAGE-BREAK-BEFORE: [^\s;]+;?"/gi,"\""),t=t.replace(/\s*FONT-VARIANT: [^\s;]+;?"/gi,"\""),t=t.replace(/\s*tab-stops:[^;"]*;?/gi,""),t=t.replace(/\s*tab-stops:[^"]*/gi,""),t=t.replace(/\s*face="[^"]*"/gi,""),t=t.replace(/\s*face=[^ >]*/gi,""),t=t.replace(/\s*FONT-FAMILY:[^;"]*;?/gi,""),t=t.replace(/<(\w[^>]*) class=([^ |>]*)([^>]*)/gi,"<$1$3"),t=t.replace(/<(\w[^>]*) style="([^\"]*)"([^>]*)/gi,"<$1$3"),t=t.replace(/\s*style="\s*"/gi,""),t=t.replace(/<SPAN\s*[^>]*>\s*&nbsp;\s*<\/SPAN>/gi,"&nbsp;"),t=t.replace(/<SPAN\s*[^>]*><\/SPAN>/gi,""),t=t.replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3"),t=t.replace(/<SPAN\s*>(.*?)<\/SPAN>/gi,"$1"),t=t.replace(/<\\?\?xml[^>]*>/gi,""),t=t.replace(/<\/?\w+:[^>]*>/gi,""),t=t.replace(/<H\d>\s*<\/H\d>/gi,""),t=t.replace(/<H1([^>]*)>/gi,""),t=t.replace(/<H2([^>]*)>/gi,""),t=t.replace(/<H3([^>]*)>/gi,""),t=t.replace(/<H4([^>]*)>/gi,""),t=t.replace(/<H5([^>]*)>/gi,""),t=t.replace(/<H6([^>]*)>/gi,""),t=t.replace(/<\/H\d>/gi,"<br>"),t=t.replace(/<(U|I|STRIKE)>&nbsp;<\/\1>/g,"&nbsp;"),t=t.replace(/<(B|b)>&nbsp;<\/(B|b)>/g,""),t=t.replace(/<([^\s>]+)[^>]*>\s*<\/\1>/g,""),t=t.replace(/<([^\s>]+)[^>]*>\s*<\/\1>/g,""),t=t.replace(/<([^\s>]+)[^>]*>\s*<\/\1>/g,"");var n=/(<P)([^>]*>.*?)(<\/P>)/gi;return t=t.replace(n,"<div$2</div>"),t=t.replace(/<span style="font-size\s*>(.*?)<\/span>/gi,"$1"),t=t.replace(/<p class="Mso\s*>(.*?)<\/p>/gi,"$1"),t=t.replace(/\n/g," ").replace(/\\r\\n/g," "),t}})}();